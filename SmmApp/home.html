<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta name="viewport"
        content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <meta name="flexible" content="initial-dpr=1" />
    <script>
        var random = Math.random();
        document.write('<link href="css/home.css?v=' + random + '" rel="stylesheet" type="text/css"/>');
    </script>
    <title>Happy Thanksgiving</title>
    <link rel="stylesheet" href="css/alert.css">
    <link rel="stylesheet" href="css/mobileSelect.css">
    <script src="js/jquery.min.js"></script>
    <script src='js/alert.js'></script>
    <script src='js/openApp.js'></script>
    <script>
        var now = new Date().getTime();
        document.write('<script src="js/result.js?v=' + now + '"><\/script\>');
    </script>
    <script src="js/viewport.js"></script>
    <script src="js/mobileSelect.js"></script>
    <script>
        var startIndex = 0;
        $(document).ready(function () {

            $("#app").on("click", ".option", function () {
                $(this).parent().children().removeClass("selected");
                $(this).addClass("selected");
                var list = $('.card-list');
                list.children().eq(startIndex).find(".cp-btn").removeClass("cp-btn--disabled");
            });

            $("#app").on("click", ".icon-back", function () {
                startHtml();
            });
            $("#app").on("click", ".startaction", function () {
                // startExam();
            });

            $("#app").on("click", ".nextaction", function () {
                if ($(this).hasClass("cp-btn--disabled")) return;
                var list = $('.card-list');
                var length = list.children().length;
                if (startIndex == length - 1) {
                    if (goDownLoad()) return;
                    $('.option').hasClass("selected");
                    var options = $('.option.selected');
                    var value = '';
                    for (let index = 0; index < options.length; index++) {
                        value += options[index].attributes['data-optionid'].value;
                    }
                    window.location = 'result.html?smm_platform=' + platform + '&radom=' + Date.now() + '&options=' + value;
                } else {
                    list.children().removeClass('prev').removeClass('active');
                    list.children().eq(startIndex).hide();
                    list.children().eq(startIndex).addClass('prev').removeClass('active').removeClass('next2');
                    list.children().eq(startIndex).next().removeClass('next').addClass('active');
                    list.children().eq(startIndex).next().next().removeClass('next2').addClass('next');
                    startIndex += 1;
                }
            });

            function startHtml() {
                startIndex = 0;
                var appWidth = $("#app").width();
                var appHeight = $("body").height();
                var height = appWidth * 138.0 / 300;
                $(".icon-back").hide();
                $('.card-list').attr("style", "background-size: " + (appWidth) + "px  " + height + "px;background-position:right bottom;");
                var starHtml = '<div class="card-box active"><div class="card"><div class="question-wrap"><div class="question fs-30 text-center"><span class="d-ibm icon-wrap"><i class="d-b icon-starttop"></i></span></div><div class="question fs-30 text-center">' +
                    'Test which celebrity you match the most' +
                    '</div><div class="question fs-24 text-center">' +
                    'Share to your friends to have fun together' +
                    '</div><ul class="options"><div class="option-line" style="height: 15px"></div><div class="action-wrap"><div class="cp-btn startaction cp-btn--yellow">' +
                    'start</div></div></ul><div class="question fs-start-18 text-center"><br>' +
                    'Share to your friends to have fun together</div></div></div></div>';
                $('.card-list').empty();
                $('.card-list').append(starHtml);
                if (appWidth < 375) {
                    $('.fs-30').attr("style", "font-size:25px");
                    $('.fs-24').attr("style", "font-size:20px");
                    $('.fs-18').attr("style", "font-size:15px");
                }
            }

            function startExam() {
                $('.card-list').empty();
                $(".icon-back").show();
                var appWidth = $("#app").width();
                var appHeight = $("body").height();
                $('.card-list').attr("style", "background-size: 300px 138px;background-position:right bottom;");
                for (var i = 0; i < dataExam.length; i++) {
                    var element = dataExam[i];
                    var optionHtml = '<div class="card-box next2"><div class="card flex"><div class="question-wrap"><div class="question fs-18">';
                    if (i == 0) {
                        optionHtml = '<div class="card-box active"><div class="card"><div class="question-wrap"><div class="question fs-18">';
                    } else if (i == 1) {
                        optionHtml = '<div class="card-box next"><div class="card"><div class="question-wrap"><div class="question fs-18">';
                    }
                    optionHtml += (i + 1) + '. ' + element.title;
                    optionHtml += '</div><ul class="options"><div data-optionid="A" class="fs-16 option"><div class="option-content flex__item">';
                    optionHtml += element.a;
                    optionHtml += '</div></div><div class="option-line"></div><div data-optionid="B" class="fs-16 option"><div class="option-content flex__item">';
                    optionHtml += element.b;
                    optionHtml += '</div></div><div class="option-line"></div><div class="option-line"></div>';
                    optionHtml += '<div class="action-wrap"><div class="nextaction cp-btn cp-btn--yellow cp-btn--disabled">';
                    if (i == dataExam.length - 1) {
                        optionHtml += '&nbsp;&nbsp;' + 'Submission'.toUpperCase() + '&nbsp;&nbsp;';
                    } else {
                        optionHtml += 'NEXT';
                    }
                    optionHtml += '</div></div></ul></div></div></div>';
                    $('.card-list').append(optionHtml);
                }
            }

            function dataMobileSelect(){
                var years = [];
                var month = [];
                var day = [];
                var myDate = new Date();
                myDate.getFullYear();    //获取完整的年份(4位,1970-????)
                myDate.getMonth();       //获取当前月份(0-11,0代表1月)
                myDate.getDate();
                var _data = [];
                for (i = 0; i < myDate.getFullYear() - 1980; i++) {
                    //年
                    var obj = {};
                    var yer = 1980 + i + 1;
                    obj.value = 1980 + i + 1;
                    var _data2 = [];
                    for (n = 0; n < 12; n++) {
                        //月
                        var obj2 = {};
                        if (n < 9) {
                            obj2.value = '0' + (n + 1);
                        } else {
                            obj2.value = n + 1;
                        }
                        var _data3 = [];
                        if (n == 1) {
                            var cond1 = yer % 4 == 0;  //条件1：年份必须要能被4整除
                            var cond2 = yer % 100 != 0;  //条件2：年份不能是整百数
                            var cond3 = yer % 400 == 0;
                            var cond = cond1 && cond2 || cond3;
                            //闰年
                            if (cond) {
                                for (y = 0; y < 29; y++) {
                                    //日
                                    var obj3 = {};
                                    if (y < 9) {
                                        obj3.value = '0' + (y + 1);
                                    } else {
                                        obj3.value = y + 1;
                                    }
                                    _data3.push(obj3)
                                }
                            } else {
                                for (y = 0; y < 28; y++) {
                                    //日
                                    var obj3 = {};
                                    if (y < 9) {
                                        obj3.value = '0' + (y + 1);
                                    } else {
                                        obj3.value = y + 1;
                                    }
                                    _data3.push(obj3)
                                }
                            }
                        } else if (n == 0 || n == 2 || n == 4 || n == 6 || n == 7 || n == 9 || n == 11) {
                            for (y = 0; y < 31; y++) {
                                //日
                                var obj3 = {};
                                if (y < 9) {
                                    obj3.value = '0' + (y + 1);
                                } else {
                                    obj3.value = y + 1;
                                }
                                _data3.push(obj3)
                            }
                        } else {
                            for (y = 0; y < 30; y++) {
                                //日
                                var obj3 = {};
                                if (y < 9) {
                                    obj3.value = '0' + (y + 1);
                                } else {
                                    obj3.value = y + 1;
                                }
                                _data3.push(obj3)
                            }
                        }
                        obj2.childs = _data3;
                        _data2.push(obj2);
                    }
                    obj.childs = _data2;
                    _data.push(obj)
                }
                var mobileSelect1 = new MobileSelect({
                    trigger: '.startaction',
                    title: '日期选择',
                    wheels: [
                        { data: _data }
                    ],
                    transitionEnd: function (indexArr, data) {
                        console.log(data);
                    },
                    callback: function (indexArr, data) {
                        console.log(data);
                        $("#trigger1").val(data[0].value + '-' + data[1].value + '-' + data[2].value)
                    }
                });
            }


            topBar();
            startHtml();
            dataMobileSelect();
        });

        $(window).load(function () {
            loadFunction();
        });

    </script>
</head>

<body>
    <div id="app">
        <div class="topbar">
            <div class="s-tabcell topbar-left fl"><span class="d-ibm icon-wrap"><i class="d-b icon-back"></i></span>
            </div>
            <div class="fs-23 topbar-title s-tabcell"><span class="d-ibm">Happy Thanksgiving</span></div>
            <div class="s-tabcell topbar-right fr"></div>
        </div>
        <div class="page-answer ">
            <div class="card-list">
                <div class="card-box active">

                </div>
            </div>
            <div class="page-mark flex">
                <i class="d-b icon-ios flex__item"></i>
                <i class="d-b icon-andriod flex__item "></i>
            </div>
        </div>
    </div>
</body>

</html>